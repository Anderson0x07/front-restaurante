<p-dataView #dv [value]="productosFiltrados" layout="grid">
    <ng-template pTemplate="header">
        <div *ngIf="categoriasCargadas" class="flex flex-column md:flex-row md:justify-content-between">
            <p-dropdown [options]="categorias" optionLabel="label" optionValue="value"
                placeholder="Ordenar por categoria" (onChange)="onSortChange($event)"
                styleClass="mb-2 md:mb-0"></p-dropdown>
        </div>
    </ng-template>

    <ng-template let-productosFiltrados pTemplate="grid">
        <div class="grid grid-nogutter">
            <div class="col-12 sm:col-6 lg:col-12 xl:col-4 p-2" *ngFor="let item of productosFiltrados">
                <div class="p-4 border-1 surface-border surface-card border-round shadow-4">
                    <div class="flex flex-wrap align-items-center justify-content-between gap-2">
                        <span class="flex align-items-center gap-2">
                            <i class="pi pi-tag"></i>
                            <span class="font-semibold">{{ item.categoria.nombre }}</span>
                        </span>
                        <p-tag [value]="(item.stock && item.stock <= 0) ? 'NO DISPONIBLE' : 'DISPONIBLE'"
                            [severity]="getSeverity(item)"></p-tag>
                    </div>
                    <div class="flex flex-column align-items-center gap-3 py-5">
                        <img class="w-9 shadow-2 border-round" [src]="url + item.imagen" [alt]="item.nombre" />
                        <div class="text-2xl font-bold">{{ item.nombre }}</div>
                    </div>
                    <div class="flex align-items-center justify-content-between">
                        <span class="text-2xl font-semibold">{{ '$ ' + (item.precio | number) }}</span>
                        <p-button icon="pi pi-shopping-cart" severity="secondary" size="large" [rounded]="true"
                            (click)="abrirModalAgregarProducto(item)"></p-button>
                    </div>
                </div>
            </div>
        </div>
    </ng-template>
    <ng-template pTemplate="emptymessage">
        no data
    </ng-template>
</p-dataView>

<p-dialog *ngIf="visible" header="Agregar al carrito" [(visible)]="visible" [modal]="true" [style]="{ width: '500px' }"
    [draggable]="false" [resizable]="false">

    <div class="grid col-12">
        <div class="col-6">
            <img *ngIf="fotoProducto" [src]="fotoProducto" alt="Vista previa de la imagen" width="200" height="200"
                class="mt-2 mx-auto mb-5 block shadow-2">

        </div>
        <div class="col-6">

            <div class="text-2xl font-bold">{{ productoSeleccionado.nombre }}</div>

            <p class="my-4">
                {{ productoSeleccionado.descripcion }}
            </p>

            <span class="text-2xl font-semibold">{{ '$ ' + (productoSeleccionado.precio | number) }}</span>

            <div class="flex justify-content-center align-items-center gap-4 my-4">
                <p-button (click)="seleccionarCantidad('resta')" icon="pi pi-minus" [rounded]="true"
                    [disabled]="cantidadSeleccionada<=0">
                </p-button>
                <p class="text-lg font-semibold m-0">
                    {{ cantidadSeleccionada }}
                </p>
                <p-button (click)="seleccionarCantidad('suma')" icon="pi pi-plus" [rounded]="true"
                    [disabled]="!hayDisponibilidad()">
                </p-button>
            </div>

            <div class="mt-4">
                <p-button [disabled]="cantidadSeleccionada <= 0" (click)="agregarCarrito()" label="Agregar"
                    iconPos="right" icon="pi pi-shopping-cart" styleClass="w-full">
                </p-button>
            </div>
        </div>

    </div>
    <!-- <ng-template pTemplate="footer">
        <p-button icon="pi pi-check" (click)="visible = false" label="Ok" pAutoFocus [autofocus]="true"></p-button>
    </ng-template> -->
</p-dialog>